<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.RadioButton?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.ToggleGroup?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="768" prefWidth="1024" style="-fx-background-color: #f5f5f5;" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="application.controllers.PaymentController">

    <!-- Top Navigation Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-background-color: #667eea; -fx-padding: 12;">
            <ImageView fitHeight="40.0" fitWidth="40.0" pickOnBounds="true" preserveRatio="true">
                <Image url="@../Images/iGo_icon.png" />
            </ImageView>
            <Label text="iGo TVM System - Payment" textFill="white">
                <font><Font name="System Bold" size="20.0" /></font>
            </Label>
            <Region HBox.hgrow="ALWAYS" />
        </HBox>
    </top>

    <!-- Main Content -->
    <center>
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" style="-fx-background-color: #f5f5f5; -fx-background: #f5f5f5;" vbarPolicy="AS_NEEDED">
            <VBox alignment="TOP_CENTER" spacing="30" style="-fx-padding: 40;">

                <!-- Title -->
                <Label text="Complete Your Payment" textFill="#333333">
                    <font><Font name="System Bold" size="28.0" /></font>
                </Label>

                <!-- Total Amount Display -->
                <VBox alignment="CENTER" spacing="10" style="-fx-background-color: white; -fx-background-radius: 15; -fx-padding: 25;                              -fx-border-color: #ddd; -fx-border-radius: 15; -fx-max-width: 700;                              -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">
                    <Label style="-fx-font-size: 16; -fx-text-fill: #666;" text="Total Amount" />
                    <Label fx:id="totalAmountLabel" style="-fx-font-size: 36; -fx-font-weight: bold; -fx-text-fill: #667eea;" text="\$0.00" />
                </VBox>

                <!-- Payment Method Selection -->
                <VBox alignment="CENTER" spacing="20" style="-fx-background-color: white; -fx-background-radius: 15; -fx-padding: 30;                              -fx-border-color: #ddd; -fx-border-radius: 15; -fx-max-width: 700;                              -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">

                    <Label style="-fx-font-size: 18; -fx-font-weight: bold; -fx-text-fill: #333;" text="Select Payment Method" />

                    <!-- Payment Options -->
                    <HBox alignment="CENTER" spacing="20">
                        <VBox alignment="CENTER" prefWidth="150" spacing="8" style="-fx-border-color: #ddd; -fx-border-radius: 10; -fx-padding: 15;                                      -fx-background-color: #f9f9f9; -fx-background-radius: 10;">
                            <Label style="-fx-font-size: 32;" text="ðŸ’µ" />
                            <RadioButton fx:id="cashRadio" style="-fx-font-size: 14; -fx-font-weight: bold;" text="Cash">
                                <toggleGroup>
                                    <ToggleGroup fx:id="paymentMethodGroup" />
                                </toggleGroup>
                            </RadioButton>
                        </VBox>

                        <VBox alignment="CENTER" prefWidth="150" spacing="8" style="-fx-border-color: #ddd; -fx-border-radius: 10; -fx-padding: 15;                                      -fx-background-color: #f9f9f9; -fx-background-radius: 10;">
                            <Label style="-fx-font-size: 32;" text="ðŸ’³" />
                            <RadioButton fx:id="creditCardRadio" selected="true" style="-fx-font-size: 14; -fx-font-weight: bold;" text="Credit Card" toggleGroup="$paymentMethodGroup" />
                        </VBox>

                        <VBox alignment="CENTER" prefWidth="150" spacing="8" style="-fx-border-color: #ddd; -fx-border-radius: 10; -fx-padding: 15;                                      -fx-background-color: #f9f9f9; -fx-background-radius: 10;">
                            <Label style="-fx-font-size: 32;" text="ðŸ¦" />
                            <RadioButton fx:id="debitCardRadio" style="-fx-font-size: 14; -fx-font-weight: bold;" text="Debit Card" toggleGroup="$paymentMethodGroup" />
                        </VBox>

                        <VBox alignment="CENTER" prefWidth="150" spacing="8" style="-fx-border-color: #ddd; -fx-border-radius: 10; -fx-padding: 15;                                      -fx-background-color: #f9f9f9; -fx-background-radius: 10;">
                            <Label style="-fx-font-size: 32;" text="NFC" />
                            <RadioButton fx:id="nfcRadio" style="-fx-font-size: 14; -fx-font-weight: bold;" text="Card Tap" toggleGroup="$paymentMethodGroup" />
                        </VBox>
                        <Button fx:id="nfcButton"
                                onAction="#handleNFCPayment"       managed="false"
                                visible="false"
                                prefWidth="250"
                                alignment="CENTER"
                                contentDisplay="GRAPHIC_ONLY"      style="-fx-background-color: #f0f0f0;
               -fx-padding: 0;             -fx-border-color: #667eea;
               -fx-border-width: 3;
               -fx-border-radius: 5;
               -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);
               -fx-cursor: hand;">

                            <graphic>
                                <VBox alignment="CENTER" spacing="10" prefWidth="250" style="-fx-padding: 20;">
                                    <Label style="-fx-font-size: 60px;" text="ðŸ‘†" />
                                    <Label style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #333;" text="Tap Credit/Debit Card here" alignment="CENTER" wrapText="true"/>
                                    <Label style="-fx-font-size: 14px; -fx-text-fill: #666;" text="Hold your card near the reader." alignment="CENTER" wrapText="true"/>
                                </VBox>
                            </graphic>
                        </Button>
                    </HBox>



                    <!-- Card Details Box -->
                    <VBox fx:id="cardDetailsBox" spacing="15" style="-fx-background-color: #f0f0f0; -fx-padding: 20;                                  -fx-border-color: #cccccc; -fx-border-width: 2; -fx-border-radius: 5;">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold;" text="Enter Card Details" />

                        <VBox spacing="8">
                            <Label style="-fx-font-size: 14px;" text="Card Number" />
                            <TextField fx:id="cardNumberField" promptText="1234 5678 9012 3456" style="-fx-font-size: 14px; -fx-padding: 10;" />
                        </VBox>

                        <HBox spacing="15">
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label style="-fx-font-size: 14px;" text="Expiry Date" />
                                <TextField fx:id="expiryField" promptText="MM/YY" style="-fx-font-size: 14px; -fx-padding: 10;" />
                            </VBox>

                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label style="-fx-font-size: 14px;" text="CVV" />
                                <TextField fx:id="cvvField" promptText="123" style="-fx-font-size: 14px; -fx-padding: 10;" />
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- Cash Payment Box -->
                    <VBox fx:id="cashPaymentBox" managed="false" spacing="15" style="-fx-background-color: #f0f0f0; -fx-padding: 20;                                  -fx-border-color: #cccccc; -fx-border-width: 2; -fx-border-radius: 5;" visible="false">

                        <Label style="-fx-font-size: 18px; -fx-font-weight: bold;" text="Insert Cash" />

                        <!-- Cash Inserted Display -->
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label style="-fx-font-size: 14px;" text="Cash Inserted:" />
                            <Label fx:id="cashInsertedLabel" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: green;" text="\$0.00" />
                        </HBox>

                        <!-- Bills Section -->
                        <VBox spacing="10">
                            <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="Bills:" />
                            <HBox alignment="CENTER" spacing="10">
                                <Button fx:id="bill100" onAction="#handleCashInsert" style="-fx-min-width: 80px; -fx-min-height: 50px;                                                -fx-background-color: #90EE90; -fx-font-size: 14px;                                                -fx-font-weight: bold; -fx-cursor: hand;" text="\$100" />
                                <Button fx:id="bill50" onAction="#handleCashInsert" style="-fx-min-width: 80px; -fx-min-height: 50px;                                                -fx-background-color: #FFB6C1; -fx-font-size: 14px;                                                -fx-font-weight: bold; -fx-cursor: hand;" text="\$50" />
                                <Button fx:id="bill20" onAction="#handleCashInsert" style="-fx-min-width: 80px; -fx-min-height: 50px;                                                -fx-background-color: #98FB98; -fx-font-size: 14px;                                                -fx-font-weight: bold; -fx-cursor: hand;" text="\$20" />
                            </HBox>
                            <HBox alignment="CENTER" spacing="10">
                                <Button fx:id="bill10" onAction="#handleCashInsert" style="-fx-min-width: 80px; -fx-min-height: 50px;                                                -fx-background-color: #DDA0DD; -fx-font-size: 14px;                                                -fx-font-weight: bold; -fx-cursor: hand;" text="\$10" />
                                <Button fx:id="bill5" onAction="#handleCashInsert" style="-fx-min-width: 80px; -fx-min-height: 50px;                                                -fx-background-color: #87CEEB; -fx-font-size: 14px;                                                -fx-font-weight: bold; -fx-cursor: hand;" text="\$5" />
                            </HBox>
                        </VBox>

                        <!-- Coins Section -->
                        <VBox spacing="10">
                            <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="Coins:" />
                            <HBox alignment="CENTER" spacing="10">
                                <Button fx:id="coin2" onAction="#handleCashInsert" style="-fx-min-width: 60px; -fx-min-height: 60px;                                                -fx-background-radius: 30; -fx-background-color: #FFD700;                                                -fx-font-size: 12px; -fx-font-weight: bold; -fx-cursor: hand;" text="\$2" />
                                <Button fx:id="coin1" onAction="#handleCashInsert" style="-fx-min-width: 60px; -fx-min-height: 60px;                                                -fx-background-radius: 30; -fx-background-color: #FFD700;                                                -fx-font-size: 12px; -fx-font-weight: bold; -fx-cursor: hand;" text="\$1" />
                                <Button fx:id="coin025" onAction="#handleCashInsert" style="-fx-min-width: 55px; -fx-min-height: 55px;                                                -fx-background-radius: 27.5; -fx-background-color: #C0C0C0;                                                -fx-font-size: 11px; -fx-font-weight: bold; -fx-cursor: hand;" text="25Â¢" />
                            </HBox>
                            <HBox alignment="CENTER" spacing="10">
                                <Button fx:id="coin010" onAction="#handleCashInsert" style="-fx-min-width: 45px; -fx-min-height: 45px;                                                -fx-background-radius: 22.5; -fx-background-color: #C0C0C0;                                                -fx-font-size: 10px; -fx-font-weight: bold; -fx-cursor: hand;" text="10Â¢" />
                                <Button fx:id="coin005" onAction="#handleCashInsert" style="-fx-min-width: 40px; -fx-min-height: 40px;                                                -fx-background-radius: 20; -fx-background-color: #CD7F32;                                                -fx-font-size: 10px; -fx-font-weight: bold; -fx-cursor: hand;" text="5Â¢" />
                            </HBox>
                        </VBox>

                        <!-- Change Display -->
                        <HBox fx:id="changeBox" alignment="CENTER_LEFT" managed="false" spacing="10" style="-fx-background-color: #ffffcc; -fx-padding: 10;                                      -fx-border-color: #ff9900; -fx-border-width: 2; -fx-border-radius: 5;" visible="false">
                            <Label style="-fx-font-size: 14px; -fx-font-weight: bold;" text="ðŸ’° Change:" />
                            <Label fx:id="changeLabel" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #ff9900;" text="\$0.00" />
                        </HBox>
                    </VBox>



                    <!-- Error/Status Label -->
                    <Label fx:id="statusLabel" style="-fx-font-size: 14px; -fx-font-weight: bold;" textFill="red" visible="false" wrapText="true" />
                </VBox>

                <!-- Action Buttons -->
                <HBox alignment="CENTER" spacing="20" style="-fx-padding: 20 0 40 0;">
                    <Button onAction="#handleCancel" prefHeight="45" prefWidth="140" style="-fx-background-color: #e0e0e0; -fx-text-fill: #333;                                    -fx-background-radius: 8; -fx-font-size: 15;" text="Cancel" />
                    <Button onAction="#handleProcessPayment" prefHeight="45" prefWidth="180" style="-fx-background-color: #667eea; -fx-text-fill: white;                                    -fx-background-radius: 8; -fx-font-size: 15; -fx-font-weight: bold;" text="Process Payment" />
                </HBox>
            </VBox>
        </ScrollPane>
    </center>

    <!-- Bottom Bar -->
    <bottom>
        <HBox alignment="CENTER" style="-fx-background-color: #333; -fx-padding: 10;">
            <Label opacity="0.7" text="Â© 2025 iGo TVM System | Secure Payment Processing" textFill="white">
                <font><Font size="11.0" /></font>
            </Label>
        </HBox>
    </bottom>
</BorderPane>
